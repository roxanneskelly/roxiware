<div class="series">
  <div class="series_info">
    <div class="series_title"><%= @series.title %></div>
    <div class="series_description"><%= raw @series.description %></div>
  </div>
  <section class="books_listing">
    <% @series.books.each do |book| %>
      <article class="book_listing" book_id="<%= book.id %>" rel="<%= book_path(book.id) %>">
	<img src="<%= book.thumbnail_url %>" class="small_book_cover"/>
	<a href="<%= book_path(book.seo_index) %>"><div class="book_title"><%= book.title %></div></a>
      </article>
    <% end %>
  </section>
</div>
<% if can? :edit, @series %>
    <ul id="series_show_application_menu" class="application_menu"><li>Series<ul>
       <li><a rel="<%= edit_book_series_path(@series.id)%>" form="Edit Series">Edit</a></li>
       <li><a id="delete_series_app_menu" form="Delete Series">Delete</a></li>
    </ul></li></ul>
   <%= render :partial=>"roxiware/books/series/context_menus" %>
   <ul id="series_context_menu" class="context_menu">
      <li id="edit_series"><a menu_item="edit_series">Edit Series</a></li>
      <li id="delete_series"><a menu_item="delete_series">Edit Series</a></li>
   </ul>
   <script>
     $(document).bind("ready", function() {
       $("#mainBody").context_menu("#series_context_menu");
       $("#delete_series_app_menu").click(function() {
           $("#mainBody").trigger("context_menu", "delete_series");
       });
       $("#mainBody").on("context_menu", function(event, menu_item) {
	  switch (menu_item) {
	     case "edit_series":
	       settingsForm("<%= new_book_path %>");
	       break;
	     case "delete_series":
	       if(confirm("Remove Series\nAre you sure?")) {
		 $.ajax({url:"<%= book_series_path(@series.id)%>",
			 type:"DELETE",
			 dataType: "json",
			 success: function(json_data, textStatus, jqXHR) {
			    window.location = "<%= books_path %>";
			 }
		  });
	       }
	       break;
	  };
     });
   });
   </script>
<% end %>
