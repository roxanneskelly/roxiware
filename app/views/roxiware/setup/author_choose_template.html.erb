<div id="setup_choose_template_form">
   <%= render :partial=>"roxiware/templates/picker", :locals=>{:selected_scheme=>@default_scheme, :selected_template=>@default_template } %>
</div>
<div class="setup_buttons"><%= button_tag "<< Back", :id=>"back_button", :value=>"back", :type=>"button"%></div>
<%= form_tag("setup", :method=>"put") do |template_form| %>
    <%= hidden_field_tag :setup_step, @setup_step %>
     <%= hidden_field_tag :setup_action, "save" %>
<% end %>

<script>
$(function() {
     $("button#back_button").click(function() {
        $("input#setup_action").val($(this).attr("id"));
        $("form").submit();
     });
    $("div#template_popup button#save_template").click(function() {
	 $.ajax({type:"PUT",
		 processData: true,
		  url: "<%= setup_path %>",
		  data: {template_guid:$("div#template_popup_form").attr("template_guid"),
                         template_scheme:$("div#template_popup_form").attr("template_scheme"),
                         setup_step:"<%=@setup_step%>",
                         setup_action:$(this).attr("id")
                         },
		  error: function(xhr, textStatus, errorThrown) {
		  },
		  complete: function() {
                      window.location="<%= setup_path %>";
		  },
		  success: function() {
		  }}); 

    });
});
</script>
